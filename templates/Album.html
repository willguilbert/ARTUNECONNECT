{% extends 'NavBar.html' %} {% block head %}
<link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
        rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
        crossorigin="anonymous"
/>
<link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
/>
 <link href="{{ url_for('static', filename='/style/test.css') }}" rel="stylesheet"/>
<link
        rel="stylesheet"
        href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css"
/>
<script
        src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"
></script>
<script
        src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"
></script>
<script
        src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"
></script>

<script src="{{ url_for('static', filename='/JS/script.js') }}"></script>
{% endblock %} {% block content %}
<div class="container mt-5">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="text-center">
        {% for category, message in messages %}
        <div class="alert alert-{{ category }} {{ 'alert-success' if category == 'success' else 'alert-danger' }}"
             role="alert">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}
    <div class="row">
        <div class="col-md-4">
            <img
                    src="{{ album['album']['photo_album'] }}"
                    class="img-fluid mb-3"
                    alt="Album"
            />
        </div>
        <div class="col-md-8">
            <h2>{{ album['album']['titre'] }}</h2>
            <a
                    href="{{ url_for('artiste', artiste_nom=album['artiste']['nom_artiste'])}}"
                    class="text-dark"
            ><p><span class="artist-name">{{ album['artiste']['nom_artiste'] }}</span></p>
             </a
            >
            <button class="btn btn-outline-secondary" disabled>
                #{{ album['style'] }}
            </button>
            <div>
                <span>Durée : </span><span class="album-duration">{{ album['album']['duree'] }}</span
            ><span> minutes</span>
            </div>
            <div>
        <span>Année parution : </span
        ><span>{{ album['album']['annee_parution'] }}</span>
            </div>
            <!-- Button trigger modal -->
            <button
                    type="button"
                    class="btn btn-primary"
                    data-toggle="modal"
                    data-target="#exampleModal"
            >
                Noter
            </button>

            <!-- Modal -->
            <div
                    class="modal fade"
                    id="exampleModal"
                    tabindex="-1"
                    role="dialog"
                    aria-labelledby="exampleModalLabel"
                    aria-hidden="true"
            >
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">
                                Noter {{album['album']['titre']}}
                            </h5>
                            <button
                                    type="button"
                                    class="close"
                                    data-dismiss="modal"
                                    aria-label="Close"
                            >
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="star-rating">
                                {% if 'loggedin' in session and session['loggedin'] %}
                                <form
                                        action="{{ url_for('submit_rating_and_review') }}"
                                        method="post"
                                >
                                    <input
                                            type="hidden"
                                            name="album_titre"
                                            value="{{ album['album']['titre'] }}"
                                    />
                                    <input
                                            type="hidden"
                                            name="artiste_id"
                                            value="{{ album['artiste']['id_artiste'] }}"
                                    />
                                    <input
                                            type="hidden"
                                            name="id_album"
                                            value="{{ album['album']['id_album'] }}"
                                    />
                                    <div class="stars">
                                        <i class="lar la-star" data-value="1"></i>
                                        <i class="lar la-star" data-value="2"></i>
                                        <i class="lar la-star" data-value="3"></i>
                                        <i class="lar la-star" data-value="4"></i>
                                        <i class="lar la-star" data-value="5"></i>
                                    </div>
                                    <input type="hidden" name="note" id="note" value="0"/>
                                    <div class="mb-3">
                                        <label for="review" class="form-label">Noter</label>
                                        <textarea
                                                class="form-control"
                                                name="review"
                                                id="review"
                                                rows="3"
                                        ></textarea>
                                    </div>
                                    {% else %}
                                    <p>Veuillez vous connecter pour envoyer une revue.</p>
                                    {% endif %}
                            </div>
                        </div>
                        <div class="modal-footer">
                            {% if 'loggedin' in session and session['loggedin'] %}
                            <button type="submit" class="btn btn-primary">Envoyer</button>
                            {% endif %}
                            <button
                                    type="button"
                                    class="btn btn-secondary"
                                    data-dismiss="modal"
                            >
                                Fermer
                            </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-6">
            {% if 'id' in session %}
            <form action="/buyAlbum" method="post">
                <input type="hidden" name="buyAlbumId" value="{{ album['album']['id_produit'] }}">
                <button class="btn btn-warning"><i class="fas fa-dollar-sign"></i>Acheter</button>
            </form>
            {% endif %}
        </div>
        <div class="row">
            <div class="col-12">
                <a href="https://www.spotify.com" class="btn btn-success mt-3"
                ><i class="fa fa-play-circle"></i>Jouer sur Spotify</a
                >
            </div>
            <div class="row">
                <div class="col-6">
                    <ol class="list-group list-group-numbered list-group-flush mt-3">
                        {% if album['chansons'] %} {% for chanson in album['chansons'] %}
                        <li class="list-group-item">{{ chanson['titre'] }}</li>
                        {% endfor %} {% endif %}
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="{{ url_for('static', filename='/JS/FormatDuration.js') }}"></script>
{% endblock %}
